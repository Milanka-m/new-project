{"ast":null,"code":"import _slicedToArray from \"D:\\\\Lianok\\\\dev\\\\new-project\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";\nimport { findGatewayToken, State } from '@identity.com/solana-gateway-ts';\nimport React, { useEffect, useRef, useState } from 'react';\nimport badgeSupportedGatekeeperNetworks from './constants';\nimport { clusterEndpoint } from '../config';\nimport { getSolanaConnection } from '../connection';\nimport BadgeSvg from './Badge.svg'; // Used to avoid making multiple blockchain calls when rerendering\n\nfunction usePrevious(value) {\n  var ref = useRef();\n  useEffect(function () {\n    ref.current = value;\n  }, [value]); // Only re-run if value changes\n  // Return previous value (happens before update in useEffect above)\n\n  return ref.current;\n}\n\nvar Badge = function Badge(_ref) {\n  var connection = _ref.connection,\n      gatekeeperNetwork = _ref.gatekeeperNetwork,\n      publicKey = _ref.publicKey,\n      _ref$clusterName = _ref.clusterName,\n      clusterName = _ref$clusterName === void 0 ? 'mainnet-beta' : _ref$clusterName;\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      token = _useState2[0],\n      setToken = _useState2[1];\n\n  var prevGKN = usePrevious(gatekeeperNetwork === null || gatekeeperNetwork === void 0 ? void 0 : gatekeeperNetwork.toBase58());\n  var prevPubkey = usePrevious(publicKey === null || publicKey === void 0 ? void 0 : publicKey.toBase58());\n  var prevClusterName = usePrevious(clusterName);\n  useEffect(function () {\n    // only make another call if anything changes, as we cannot\n    // rely on useEffect to protect us from this\n    if ((gatekeeperNetwork === null || gatekeeperNetwork === void 0 ? void 0 : gatekeeperNetwork.toBase58()) !== prevGKN || (publicKey === null || publicKey === void 0 ? void 0 : publicKey.toBase58()) !== prevPubkey || clusterName !== prevClusterName) {\n      var clusterUrl = clusterEndpoint(clusterName);\n      var normalizedConnection = connection || getSolanaConnection(clusterUrl); // only set the GT if one was found\n\n      findGatewayToken(normalizedConnection, publicKey, gatekeeperNetwork).then(function (gt) {\n        return setToken(gt || undefined);\n      });\n    }\n  }, [gatekeeperNetwork === null || gatekeeperNetwork === void 0 ? void 0 : gatekeeperNetwork.toBase58(), publicKey === null || publicKey === void 0 ? void 0 : publicKey.toBase58(), clusterName, connection]);\n\n  if (!badgeSupportedGatekeeperNetworks.includes(gatekeeperNetwork.toBase58())) {\n    return React.createElement(React.Fragment, null);\n  }\n\n  return (token === null || token === void 0 ? void 0 : token.state) === State.ACTIVE ? React.createElement(\"a\", {\n    href: \"https://www.civic.com\",\n    target: \"_blank\",\n    rel: \"noreferrer\",\n    \"data-testid\": \"badgeLink\"\n  }, React.createElement(BadgeSvg, null)) : React.createElement(React.Fragment, null);\n};\n\nexport default Badge;","map":{"version":3,"sources":["D:/Lianok/dev/new-project/node_modules/@civic/solana-gateway-react/dist/esm/solana/badge/Badge.js"],"names":["findGatewayToken","State","React","useEffect","useRef","useState","badgeSupportedGatekeeperNetworks","clusterEndpoint","getSolanaConnection","BadgeSvg","usePrevious","value","ref","current","Badge","connection","gatekeeperNetwork","publicKey","clusterName","token","setToken","prevGKN","toBase58","prevPubkey","prevClusterName","clusterUrl","normalizedConnection","then","gt","undefined","includes","createElement","Fragment","state","ACTIVE","href","target","rel"],"mappings":"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","sourcesContent":["import { findGatewayToken, State } from '@identity.com/solana-gateway-ts';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport badgeSupportedGatekeeperNetworks from './constants';\r\nimport { clusterEndpoint } from '../config';\r\nimport { getSolanaConnection } from '../connection';\r\nimport BadgeSvg from './Badge.svg';\r\n// Used to avoid making multiple blockchain calls when rerendering\r\nfunction usePrevious(value) {\r\n    const ref = useRef();\r\n    useEffect(() => {\r\n        ref.current = value;\r\n    }, [value]); // Only re-run if value changes\r\n    // Return previous value (happens before update in useEffect above)\r\n    return ref.current;\r\n}\r\nconst Badge = ({ connection, gatekeeperNetwork, publicKey, clusterName = 'mainnet-beta' }) => {\r\n    const [token, setToken] = useState();\r\n    const prevGKN = usePrevious(gatekeeperNetwork === null || gatekeeperNetwork === void 0 ? void 0 : gatekeeperNetwork.toBase58());\r\n    const prevPubkey = usePrevious(publicKey === null || publicKey === void 0 ? void 0 : publicKey.toBase58());\r\n    const prevClusterName = usePrevious(clusterName);\r\n    useEffect(() => {\r\n        // only make another call if anything changes, as we cannot\r\n        // rely on useEffect to protect us from this\r\n        if ((gatekeeperNetwork === null || gatekeeperNetwork === void 0 ? void 0 : gatekeeperNetwork.toBase58()) !== prevGKN ||\r\n            (publicKey === null || publicKey === void 0 ? void 0 : publicKey.toBase58()) !== prevPubkey ||\r\n            clusterName !== prevClusterName) {\r\n            const clusterUrl = clusterEndpoint(clusterName);\r\n            const normalizedConnection = connection || getSolanaConnection(clusterUrl);\r\n            // only set the GT if one was found\r\n            findGatewayToken(normalizedConnection, publicKey, gatekeeperNetwork).then((gt) => setToken(gt || undefined));\r\n        }\r\n    }, [gatekeeperNetwork === null || gatekeeperNetwork === void 0 ? void 0 : gatekeeperNetwork.toBase58(), publicKey === null || publicKey === void 0 ? void 0 : publicKey.toBase58(), clusterName, connection]);\r\n    if (!badgeSupportedGatekeeperNetworks.includes(gatekeeperNetwork.toBase58())) {\r\n        return React.createElement(React.Fragment, null);\r\n    }\r\n    return (token === null || token === void 0 ? void 0 : token.state) === State.ACTIVE ? (React.createElement(\"a\", { href: \"https://www.civic.com\", target: \"_blank\", rel: \"noreferrer\", \"data-testid\": \"badgeLink\" },\r\n        React.createElement(BadgeSvg, null))) : (React.createElement(React.Fragment, null));\r\n};\r\nexport default Badge;\r\n"]},"metadata":{},"sourceType":"module"}